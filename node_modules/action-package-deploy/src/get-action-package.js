#!/usr/bin/env node

const yargs = require("yargs");
const actionApis = require("./action-apis");
const logger = require("./logger");

const options = yargs
    .usage("Usage: -p <PackageId>")
    .option("p", { alias: "package-id", describe: "Action package ID", type: "string", demandOption: true })
    .option("e", { alias: "endpoint", describe: "Action platform endpoint", type: "string", default: "https://actions.office365.com" })
    .option("l", { alias: "log-level", describe: "Log level", choices: ["status", "info", "debug", "none"], default: "info" })
    .argv;

logger.setLogLevel(options["l"]);

async function getActionPackage(endpoint, packageId) {
    var packageMetadata = await actionApis.getActionPackage(endpoint, packageId);
    if (packageMetadata) {
        logger.logSuccess(`${JSON.stringify(packageMetadata)}`);
    } else {
        logger.logError(`Error!`);
    }
}

getActionPackage(options["e"], options["p"]);